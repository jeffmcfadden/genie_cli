#!/usr/bin/env ruby

require_relative "../lib/tdd"

if File.exist?(File.join(Dir.pwd, 'tddcli.yml'))
  config = TDD::SessionConfig.from_file(File.join(Dir.pwd, 'tddcli.yml'))
else
  config = TDD::SessionConfig.new(base_path: Dir.pwd, run_tests_cmd: "rake test")
end

session = TDD::Session.new(config: config)

# Trap CTRL+C to exit
Signal.trap("INT") do
  session.complete
end

session.begin(ARGV[0])